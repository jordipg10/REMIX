module m_idealphase
!-------------------------------------------------------------------------
!
!   $Description:
!%
!%    Módulo Phase
!%
!%    This class represent volumetric ideal phase
!%    Purpose:
!%    --------
!%    Compute the activity coefficients (gamma=1) and derivates
!%
!%
!
!   $Use:
!
!   $Author:
!
!   $License:
!
!-------------------------------------------------------------------------
use m_parentphase
use m_general_tools_cheproo
use m_constants_cheproo
!%-------------------------------------------------------------------
!%-------------------------------------------------------------------
private            ::
!%-------------------------------------------------------------------
!%-------------------------------------------------------------------
public             :: &
create_ &
,set_ &
,set_pparent_ &
,destroy_ &
,compute_act_coeff_ &
,compute_dact_coeff_ &
,update_ &
,write_ &
,assignment(=)
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
!% Type definition 
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
type, public::t_idealphase
 
type (t_parentphase), pointer   :: pp   ! Parent phase 
 
end type t_idealphase
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface create_
 
module procedure create_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface destroy_
 
module procedure destroy_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface set_
 
module procedure set_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface set_pparent_
 
module procedure set_pparent_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface compute_act_coeff_
 
module procedure compute_act_coeff_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface compute_dact_coeff_
 
module procedure compute_dact_coeff_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface update_
 
module procedure update_temp_param_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface write_
 
module procedure write_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
interface assignment(=)
 
module procedure copy_idealphase
 
end interface
!%------------------------------------------------------------------------
!%------------------------------------------------------------------------
contains
!%------------------------------------------------------------------------
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine create_idealphase &
   (this)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
type(t_idealphase) :: this 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 

!%------------------------------------------------------------
this%pp => null ()
!%------------------------------------------------------------
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine destroy_idealphase &
   (this)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
type(t_idealphase) :: this 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 

!%------------------------------------------------------------
this%pp => null ()
!%------------------------------------------------------------
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine set_idealphase &
   (this, &
    parent)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 
type(t_idealphase) :: &
 this
type(t_parentphase), pointer :: &
 parent
!%------------------------------------------------------------
this%pP => parent
!%------------------------------------------------------------
 
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine set_pparent_idealphase &
   (this, &
    parent)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:  Set the parent phase
!
!   $Arguments:
!
 
type(t_idealphase)                          :: this

type(t_parentphase), pointer                :: parent 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 

!%------------------------------------------------------------
this%pp => parent
!%------------------------------------------------------------
 
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine update_temp_param_idealphase &
   (this, &
    temp, &
    iserror)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
type(t_idealphase), intent(inout)      :: this

real*8, intent(in)                     :: temp

logical, intent(out)                   :: iserror 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 

!%------------------------------------------------------------
 iserror=.false.
!%------------------------------------------------------------
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine write_idealphase &
   (this, &
    ioutput, &
    iserror)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 
type(t_idealphase) :: &
 this
integer       :: &
 ioutput
logical       :: &
 iserror
!%------------------------------------------------------------
iserror=.false.
write (ioutput,*) '************************************'
write (ioutput,*) '     Ideal phase information        '
write (ioutput,*) '      Activity model: Ideal         '
!%-----------------------------------------------------------
call write_ (this%pp,ioutput,iserror)
!%-----------------------------------------------------------
write (ioutput,*) '************************************'
!%-----------------------------------------------------------
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine compute_act_coeff_idealphase &
   (this, &
    g, &
    c, &
	iserror)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
type(t_idealphase), intent(in)          :: this

real*8, pointer                         :: g(:)

real*8, intent(in)                      :: c(this%pp%numsp) 

logical, intent(out)                    :: iserror 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
character(len=100)                      :: &
msg 
!-------------------------------------------------------------------------
!
!   $code
!
iserror=.false. 
msg=''
!%------------------------------------------------------------
call check_pointer_ (g,this%pp%numsp,.true.)
!%------------------------------------------------------------
g = 1.0d0
!%------------------------------------------------------------
return
10 continue 
print *,'*******************************'
print *,'Phase:'
print *,'Name:', this%pp%name
print *,'Service: compute_act_coeff_'
print *, msg
print *,'*******************************'
iserror=.true.
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
subroutine compute_dact_coeff_idealphase &
   (this, &
    dg, &
    c, &
    dc, &
	iserror, &
    g,&
    dparam)
implicit none
!-------------------------------------------------------------------------
!
!   $Description:
!
!   $Arguments:
!
 
 
type(t_idealphase), intent(in) :: this

real*8, intent(in)             :: c(this%pp%numsp)

real*8, intent(in)             :: dc(:,:)

real*8,pointer                 :: dg(:,:)

real*8, intent(in), optional   :: g(this%pp%numsp)

real*8, pointer, optional      :: dparam(:) 

logical, intent(out)           :: iserror 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
logical                  :: &
 havedparam, &
 haveg
integer                  :: &
 ndim 
character(len=100)       :: &
 msg
!-------------------------------------------------------------------------
!
!   $code
!
iserror=.false.
msg='' 
!%------------------------------------------------------------
havedparam=present(dparam)
haveg=present(g)
!%------------------------------------------------------------
ndim=size(dc,2)
!%------------------------------------------------------------
call check_pointer_ (dg,this%pp%numsp,ndim,.true.)
!%------------------------------------------------------------
if (havedparam) then
  call check_pointer_ (dparam,ndim,.true.)
end if
!%------------------------------------------------------------
return
10 continue 
print *,'*******************************'
print *,'Phase:'
print *,'Name:', this%pp%name
print *,'Service: compute_dct_coeff_'
print *, msg
print *,'*******************************'
iserror=.true.
return
end subroutine
!%************************************************************
!%***************Public subroutine****************************
!%************************************************************
!%************************************************************
!%************************************************************
subroutine copy_idealphase &
  (copied, &
   this)
implicit none
!-------------------------------------------------------------------------
!
!   $Description: Copy a object in other species object.  
!
!   $Arguments:
!
 
 
 
!-------------------------------------------------------------------------
!
!   $Pre-cond:
!
!   $Post-cond:
!
!   $License:
!
!-------------------------------------------------------------------------
 
!-------------------------------------------------------------------------
!
!   $code
!
 
 
type(t_idealphase), intent(in) :: &
 this
type(t_idealphase), intent(out):: &
 copied
!%------------------------------------------------------------
copied%pp => null ()
!%------------------------------------------------------------
return
end subroutine
!%************************************************************
!%************************************************************
!%************************************************************
!%************************************************************
!%************************************************************
!%************************************************************
!%************************************************************
!%************************************************************
end module m_idealphase
